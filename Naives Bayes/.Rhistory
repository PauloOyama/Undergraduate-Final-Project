setwd("A:/Universidade/TCC/Implementação/Naives Bayes")
df = read.csv("data/spam_or_not_spam.csv")
set.seed(2)
sample <- sample(c(TRUE, FALSE), nrow(df), replace=TRUE, prob=c(0.7,0.3))
train  <- df[sample, ]
test   <- df[!sample, ]
spam = length(train$label[train$label != 0])
not_spam = length(train$label) - spam
df2 <- data.frame(words=c(""),spam=c(0),ham=c(0))
for (i in 1:nrow(train)){
if(train[i,1] == ""){
next
}
#find duplicated values
words_dup = duplicated(strsplit(train[i,1],"[[:space:]]")[[1]])
#take the distinct value
words = strsplit(train[i,1],"[[:space:]]")[[1]][!words_dup]
for (j in 1:length(words)){
if(words[j] %in% df2$words){
if(train[i,2] == 0){
df2$ham[df2$words == words[j]] = df2$ham[df2$words == words[j]] + 1
}else{
df2$spam[df2$words == words[j]] = df2$spam[df2$words == words[j]] + 1
}
}else{
df2[nrow(df2)+1,1] = c(words[j])
if(train[i,2] == 0){
df2[nrow(df2),2] = c(0)
df2[nrow(df2),3] = c(1)
}else{
df2[nrow(df2),2] = c(1)
df2[nrow(df2),3] = c(1)
}
}
}
#Maybe remove "" and NUMBER string ?
}
rm(i)
for(i in 1:nrow(df2)){
df2$spam[i] = df2$spam[i]/spam
df2$ham[i] = df2$ham[i]/not_spam
}
df2
df2
1 * df2$spam[1]
#ham
probability_ham = 1
for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_ham = probability_ham * df2$spam[j]
}else{
probability_ham = probability_ham * (1 - df2$spam[j])
}
}
}
#ham
probability_ham = 1
for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_ham = probability_ham * df2$spam[j]
}else{
probability_ham = probability_ham * (1 - df2$spam[j])
}
}
}
#ham
probability_spam = 1
for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[j]
}else{
probability_spam = probability_spam * (1 - df2$spam[j])
}
}
}
#spam
probability_spam = 1
for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[j]
}else{
probability_spam = probability_spam * (1 - df2$spam[j])
}
}
}
#spam
probability_spam = 1
for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[j]
}else{
probability_spam = probability_spam * (1 - df2$spam[j])
}
}
}
#spam
probability_spam = 1
for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[j]
}else{
probability_spam = probability_spam * (1 - df2$spam[j])
}
}
}
df2$spam[df2$words == "hello"]
#spam
probability_spam = 1
for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[df2$words == words[j]]
}else{
probability_spam = probability_spam * (1 - df2$spam[df2$words == words[j]])
}
}
}
#spam
probability_spam = 1
#for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[df2$words == words[j]]
}else{
probability_spam = probability_spam * (1 - df2$spam[df2$words == words[j]])
}
}
#for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[df2$words == words[j]]
}else{
probability_spam = probability_spam * (1 - df2$spam[df2$words == words[j]])
}
}
#for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[df2$words == words[j]]
}else{
probability_spam = probability_spam * (1 - df2$spam[df2$words == words[j]])
}
}
words
#spam
probability_spam = 1
#for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[df2$words == words[j]]
}else{
probability_spam = probability_spam * (1 - df2$spam[df2$words == words[j]])
}
}
rn(j)
rm(j)
#spam
probability_spam = 1
#for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[df2$words == words[j]]
}else{
probability_spam = probability_spam * (1 - df2$spam[df2$words == words[j]])
}
}
probability_spam = probability_spam * df2$spam[df2$words == words[1]]
#for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_spam = probability_spam * df2$spam[df2$words == words[1]]
}
#}
#ham
probability_ham = 1
for (i in 1:nrow(df2)){
for (j in 1:length(words)){
if(words[j] %in% df2$words){
probability_ham = probability_ham * df2$spam[j]
}else{
probability_ham = probability_ham * (1 - df2$spam[j])
}
}
}
}
