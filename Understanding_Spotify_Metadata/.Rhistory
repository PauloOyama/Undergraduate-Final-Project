# O primeiro disparo é o melhor filho no periodo
if (j == 1){
periodos[[i]] = epoca
}else{
# O melhor filho dessa epoca eh melhor que o filho
# do periodo ?
# Se sim, troca o filho
if(min(periodos[[i]]$f) < min(epoca$f)){
periodos[[i]] <- epoca
periodos[[i]]$count <- j
}
}
}
}
periodos <- periodos[mu]
# metodo mais facil para visualizar a media e o desvio padrao
for(i in 1:length(periodos)){
cat("MeanY = ",mean(periodos[[i]]$y), " SDY = ",sd(periodos[[i]]$x))
cat(" Mean X= ",mean(periodos[[i]]$x),", SDX = ",sd(periodos[[i]]$x)," F(x) > ", min(periodos[[i]]$f),'\n')
}
# Guarda o resultado do melhor filho em 1000 epocas
periodos <- list()
# Guarda o numero de filhos
mu <- c(1,2,5,10,15)
for(i in mu){
for(j in 1:1000){
x0 = gera_filho(i)
epoca <- ee(tmax=50, x = x0$x,y=x0$y,n = i)
# O primeiro disparo é o melhor filho no periodo
if (j == 1){
periodos[[i]] = epoca
}else{
# O melhor filho dessa epoca eh melhor que o filho
# do periodo ?
# Se sim, troca o filho
if(min(periodos[[i]]$f) < min(epoca$f)){
periodos[[i]] <- epoca
periodos[[i]]$count <- j
}
}
}
}
periodos <- periodos[mu]
# metodo mais facil para visualizar a media e o desvio padrao
for(i in 1:length(periodos)){
cat("MeanY = ",mean(periodos[[i]]$y), " SDY = ",sd(periodos[[i]]$x))
cat(" Mean X= ",mean(periodos[[i]]$x),", SDX = ",sd(periodos[[i]]$x)," F(x) > ", min(periodos[[i]]$f),'\n')
}
# Guarda o resultado do melhor filho em 1000 epocas
periodos <- list()
# Guarda o numero de filhos
mu <- c(1,2,5,10,15)
for(i in mu){
for(j in 1:1000){
x0 = gera_filho(i)
epoca <- ee(tmax=100, x = x0$x,y=x0$y,n = i)
# O primeiro disparo é o melhor filho no periodo
if (j == 1){
periodos[[i]] = epoca
}else{
# O melhor filho dessa epoca eh melhor que o filho
# do periodo ?
# Se sim, troca o filho
if(min(periodos[[i]]$f) < min(epoca$f)){
periodos[[i]] <- epoca
periodos[[i]]$count <- j
}
}
}
}
periodos <- periodos[mu]
# metodo mais facil para visualizar a media e o desvio padrao
for(i in 1:length(periodos)){
cat("MeanY = ",mean(periodos[[i]]$y), " SDY = ",sd(periodos[[i]]$x))
cat(" Mean X= ",mean(periodos[[i]]$x),", SDX = ",sd(periodos[[i]]$x)," F(x) > ", min(periodos[[i]]$f),'\n')
}
library(less)
library(Rtsne)
library(ggplot2)
library('corrr')
library(ggcorrplot)
library("FactoMineR")
library("factoextra")
set.seed(10002)
setwd("A:/Universidade/TCC/Implementação/Understanding_Spotify_Metadata/")
#metadata2 <- read.csv('./filtered_metadados_dataset.csv',header=TRUE)
meta_t <- read.csv('./metadata_woth_tracks.csv')
colnames(meta_t)
#Removing non-numeric attributes
remove_row <- c(2,3,4,18)
filt_metadata <- meta_t[,-remove_row]
cor(filt_metadata)
#Removing fields
remove_row2 <- c(7,10,13)
filt_metadata <- filt_metadata[,-remove_row2]
str(filt_metadata)
colSums(is.na(filt_metadata))
data_normalized <- scale(filt_metadata)
head(data_normalized)
corr_matrix <- cor(data_normalized)
data.pca <- princomp(corr_matrix, cor=TRUE)
summary(data.pca)
fviz_eig(data.pca, addlabels = TRUE)
fviz_pca_var(data.pca, col.var = "black")
fviz_cos2(data.pca, choice = "var", axes = 1:2)#
filt_metadata´1,
filt_metadata[1,]
data.pca$loadings
data.pca$loadings[,1]
data.pca$loadings[1,]
is1$Comp.1 <- filt_metadata[1,] %*% data.pca$loadings[,1]
is1$Comp.1 <- filt_metadata[1,] %*% data.pca$loadings[,1]
is1$Comp.1 <- filt_metadata[1,] %*% t(data.pca$loadings[,1])
is1 <- list()
is1$Comp.1 <- filt_metadata[1,] %*% t(data.pca$loadings[,1])
is1$Comp.1 <- filt_metadata[1,] %*% data.pca$loadings[,1]
filt_metadata[1,] %*% data.pca$loadings[,1]
filt_metadata[1,] %*% data.pca$loadings[,1]
data.pca$loadings[,1]
nrow(data.pca$loadings[,1])
nrows(data.pca$loadings[,1])
length(data.pca$loadings[,1])
\
length(filt_metadata[1,])
nrow()(filt_metadata[1,])
length(filt_metadata[1,])
nrow(filt_metadata[1,])
filt_metadata[1,] %*% data.pca$loadings[,1]
filt_metadata[1,] %*% as.matrix(data.pca$loadings[,1])
t(filt_metadata[1,]) %*% as.matrix(data.pca$loadings[,1])
t(filt_metadata[1,]) %*% data.pca$loadings[,1]
t(filt_metadata[1,])
data.pca$loadings[,1]
t(filt_metadata[1,]) %*% data.pca$loadings[,1]
filt_metadata[1,] %*% data.pca$loadings[,1]
filt_metadata[1,] %*% t(data.pca$loadings[,1])
filt_metadata[1,] %*% t(data.pca$loadings[1,])
t(data.pca$loadings[1,])
t(filt_metadata[1,])
data.pca$loadings[1,]
data.pca$loadings[,1]
t(data.pca$loadings[,1])
t(data.pca$loadings[1,1])
t(data.pca$loadings[1,1])
t(data.pca$loadings[,1])
as.matrix(data.pca$loadings[,1])
filt_metadata[1,] %*% as.matrix(data.pca$loadings[,1])
filt_metadata[1,]
filt_metadata[1,] %*% as.matrix(data.pca$loadings[,1])
t(filt_metadata[1,]) %*% as.matrix(data.pca$loadings[,1])
filt_metadata[1,] %*% as.matrix(data.pca$loadings[,1])
as.matrix(data.pca$loadings[,1])
as.matrix(data.pca$loadings[5,1])
as.matrix(data.pca$loadings[,1])
as.matrix(filt_metadata[1,])
filt_metadata[1,]
as.matrix(filt_metadata[1,]) %*% as.matrix(data.pca$loadings[,1])
as.matrix(filt_metadata[1,])
as.matrix(data.pca$loadings[,1])
as.matrix(data_normalized[1,]) %*% as.matrix(data.pca$loadings[,1])
data_normalized[1,]
filt_metadata[1,]
as.matrix(data_normalized[1,]) %*% as.matrix(data.pca$loadings[,1])
data_normalized[1,] %*% data.pca$loadings[,1]
data_normalized[1,]
data.pca$loadings[,1]
data_normalized[1,] %*% data.pca$loadings[,1]
summary(data.pca)
is1 <- list()
is1$Comp.1 <- data_normalized[1,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[2,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[3,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[4,] %*% data.pca$loadings[,4]
is1$Comp.4 <- data_normalized[5,] %*% data.pca$loadings[,5]
score1 <- as.data.frame(is1)
score1
is1 <- list()
is1$Comp.1 <- data_normalized[1,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[2,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[3,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[4,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[5,] %*% data.pca$loadings[,5]
score1 <- as.data.frame(is1)
score1
co<- c()
is1 <- list()
is1$Comp.1 <- data_normalized[1,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[2,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[3,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[4,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[5,] %*% data.pca$loadings[,5]
co <- c(co,is1)
co <- c(co,is1)
co
score1 <- as.data.frame(co)
score1
co<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5'))
df<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5'))
df
is1 <- c()
is1$Comp.1 <- data_normalized[1,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[2,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[3,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[4,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[5,] %*% data.pca$loadings[,5]
is1
score1 <- as.data.frame(co)
score1
list
list
list
list
is1 <- list()
is1$Comp.1 <- data_normalized[1,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[2,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[3,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[4,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[5,] %*% data.pca$loadings[,5]
score1 <- as.data.frame(co)
score1
score1 <- as.data.frame(is1)
score1
df3 = rbind(df,score1)
df3
df3 = rbind(df,score1)
df3
df3
df3 = rbind(df,score1)
df3
df = rbind(df,score1)
df
df = rbind(df,score1)
df
df<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5'))
data_normalized
nrow(data_normalized)
df<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5'))
for(i in nrow(data_normalized)){
for(i in 1:5){
is1 <- list()
is1$Comp.1 <- data_normalized[1,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[2,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[3,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[4,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[5,] %*% data.pca$loadings[,5]
score1 <- as.data.frame(is1)
}
df = rbind(df,score1)
}
df
df<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5'))
for(i in nrow(data_normalized)){
for(i in 1:5){
is1 <- list()
is1$Comp.1 <- data_normalized[1,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[2,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[3,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[4,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[5,] %*% data.pca$loadings[,5]
score1 <- as.data.frame(is1)
}
df = rbind(df,score1)
}
df
data_normalized[1,]
data_normalized[2,]
data_normalized
data.pca$loadings[,1]
data.pca$loadings[,2]
data.pca$loadings
for(i in nrow(data_normalized)){
is1 <- list()
is1$Comp.1 <- data_normalized[i,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[i,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[i,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[i,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[i,] %*% data.pca$loadings[,5]
score1 <- as.data.frame(is1)
df = rbind(df,score1)
}
df
df<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5'))
for(i in 1:nrow(data_normalized)){
is1 <- list()
is1$Comp.1 <- data_normalized[i,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[i,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[i,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[i,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[i,] %*% data.pca$loadings[,5]
score1 <- as.data.frame(is1)
df = rbind(df,score1)
}
df
summary(data.pca)
df
library(less)
library(Rtsne)
library(ggplot2)
library('corrr')
library(ggcorrplot)
library("FactoMineR")
library("factoextra")
musics <- c(52,53,102,164,178,202,213,269)
df[musics]
df[musics,]
df[-musics,]
tree_t <- df[-musics,]
test_t <- df[musics,]
kdt <- KDTree$new(tree_t)
d <- kdt$query(query_X = test_t, k = 2)
rec_musics <- c()
for(i in 1:nrow(d$nn.idx)){
rec_musics<- c(rec_musics,d$nn.idx[i,1])
rec_musics<- c(rec_musics,d$nn.idx[i,2])
}
meta_t[rec_musics,]
meta_t[rec_musics,c(1,2,4)]
a <- meta_t[rec_musics,c(1,2,4)]
View(a)
View(a)
summary(data.pca)
df<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5','Comp.6'))
for(i in 1:nrow(data_normalized)){
is1 <- list()
is1$Comp.1 <- data_normalized[i,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[i,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[i,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[i,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[i,] %*% data.pca$loadings[,5]
is1$Comp.5 <- data_normalized[i,] %*% data.pca$loadings[,6]
score1 <- as.data.frame(is1)
df = rbind(df,score1)
}
df
for(i in 1:nrow(data_normalized)){
is1 <- list()
is1$Comp.1 <- data_normalized[i,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[i,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[i,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[i,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[i,] %*% data.pca$loadings[,5]
is1$Comp.6 <- data_normalized[i,] %*% data.pca$loadings[,6]
score1 <- as.data.frame(is1)
df = rbind(df,score1)
}
df<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5','Comp.6'))
for(i in 1:nrow(data_normalized)){
is1 <- list()
is1$Comp.1 <- data_normalized[i,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[i,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[i,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[i,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[i,] %*% data.pca$loadings[,5]
is1$Comp.6 <- data_normalized[i,] %*% data.pca$loadings[,6]
score1 <- as.data.frame(is1)
df = rbind(df,score1)
}
df
musics <- c(52,53,102,164,178,202,213,269)
tree_t <- df[-musics,]
test_t <- df[musics,]
kdt <- KDTree$new(tree_t)
d <- kdt$query(query_X = test_t, k = 2)
rec_musics <- c()
for(i in 1:nrow(d$nn.idx)){
rec_musics<- c(rec_musics,d$nn.idx[i,1])
rec_musics<- c(rec_musics,d$nn.idx[i,2])
}
meta_t[rec_musics,c(1,2,4)]
b <- meta_t[rec_musics,c(1,2,4)]
View(b)
View(b)
filt_metadata
df
###
corr_matrix <- cor(df)
data.pca <- princomp(corr_matrix, cor=TRUE)
summary(data.pca)
fviz_eig(data.pca, addlabels = TRUE)
fviz_pca_var(data.pca, col.var = "black")
fviz_cos2(data.pca, choice = "var", axes = 1:2)#
fviz_pca_var(data.pca, col.var = "cos2",
gradient.cols = c("black", "orange", "green"),
repel = TRUE)
df<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5','Comp.6','Comp.7','Comp.8','Comp.9','Comp.10','Comp.11'))
for(i in 1:nrow(data_normalized)){
is1 <- list()
is1$Comp.1 <- data_normalized[i,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[i,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[i,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[i,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[i,] %*% data.pca$loadings[,5]
is1$Comp.6 <- data_normalized[i,] %*% data.pca$loadings[,6]
is1$Comp.7 <- data_normalized[i,] %*% data.pca$loadings[,7]
is1$Comp.8 <- data_normalized[i,] %*% data.pca$loadings[,8]
is1$Comp.9 <- data_normalized[i,] %*% data.pca$loadings[,9]
is1$Comp.10 <- data_normalized[i,] %*% data.pca$loadings[,10]
is1$Comp.11 <- data_normalized[i,] %*% data.pca$loadings[,11]
score1 <- as.data.frame(is1)
df = rbind(df,score1)
}
df<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5','Comp.6','Comp.7','Comp.8','Comp.9','Comp.10','Comp.11'))
for(i in 1:nrow(data_normalized)){
is1 <- list()
is1$Comp.1 <- data_normalized[i,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[i,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[i,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[i,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[i,] %*% data.pca$loadings[,5]
is1$Comp.6 <- data_normalized[i,] %*% data.pca$loadings[,6]
is1$Comp.7 <- data_normalized[i,] %*% data.pca$loadings[,7]
is1$Comp.8 <- data_normalized[i,] %*% data.pca$loadings[,8]
is1$Comp.9 <- data_normalized[i,] %*% data.pca$loadings[,9]
is1$Comp.10 <- data_normalized[i,] %*% data.pca$loadings[,10]
is1$Comp.11 <- data_normalized[i,] %*% data.pca$loadings[,11]
score1 <- as.data.frame(is1)
df = rbind(df,score1)
}
str(filt_metadata)
colSums(is.na(filt_metadata))
data_normalized <- scale(filt_metadata)
head(data_normalized)
corr_matrix <- cor(data_normalized)
data.pca <- princomp(corr_matrix, cor=TRUE)
summary(data.pca)
fviz_eig(data.pca, addlabels = TRUE)
fviz_pca_var(data.pca, col.var = "black")
fviz_cos2(data.pca, choice = "var", axes = 1:2)#
fviz_pca_var(data.pca, col.var = "cos2",
gradient.cols = c("black", "orange", "green"),
repel = TRUE)
df<- data.frame(row.names = c('Comp.1','Comp.2','Comp.3','Comp.4','Comp.5','Comp.6','Comp.7','Comp.8','Comp.9','Comp.10','Comp.11'))
for(i in 1:nrow(data_normalized)){
is1 <- list()
is1$Comp.1 <- data_normalized[i,] %*% data.pca$loadings[,1]
is1$Comp.2 <- data_normalized[i,] %*% data.pca$loadings[,2]
is1$Comp.3 <- data_normalized[i,] %*% data.pca$loadings[,3]
is1$Comp.4 <- data_normalized[i,] %*% data.pca$loadings[,4]
is1$Comp.5 <- data_normalized[i,] %*% data.pca$loadings[,5]
is1$Comp.6 <- data_normalized[i,] %*% data.pca$loadings[,6]
is1$Comp.7 <- data_normalized[i,] %*% data.pca$loadings[,7]
is1$Comp.8 <- data_normalized[i,] %*% data.pca$loadings[,8]
is1$Comp.9 <- data_normalized[i,] %*% data.pca$loadings[,9]
is1$Comp.10 <- data_normalized[i,] %*% data.pca$loadings[,10]
is1$Comp.11 <- data_normalized[i,] %*% data.pca$loadings[,11]
score1 <- as.data.frame(is1)
df = rbind(df,score1)
}
df
View(b)
View(b)
View(b)
View(b)
View(b)
View(b)
musics <- c(52,53,102,164,178,202,213,269)
tree_t <- df[-musics,]
test_t <- df[musics,]
kdt <- KDTree$new(tree_t)
d <- kdt$query(query_X = test_t, k = 2)
rec_musics <- c()
for(i in 1:nrow(d$nn.idx)){
rec_musics<- c(rec_musics,d$nn.idx[i,1])
rec_musics<- c(rec_musics,d$nn.idx[i,2])
}
b <- meta_t[rec_musics,c(1,2,4)]
###
corr_matrix <- cor(df)
data.pca <- princomp(corr_matrix, cor=TRUE)
summary(data.pca)
fviz_eig(data.pca, addlabels = TRUE)
fviz_pca_var(data.pca, col.var = "black")
fviz_cos2(data.pca, choice = "var", axes = 1:2)#
fviz_pca_var(data.pca, col.var = "black")
fviz_eig(data.pca, addlabels = TRUE)
fviz_pca_var(data.pca, col.var = "black")
fviz_cos2(data.pca, choice = "var", axes = 1:2)#
fviz_pca_var(data.pca, col.var = "cos2",
gradient.cols = c("black", "orange", "green"),
repel = TRUE)
load("~/.RData")
a <- load("~/.RData")
rm(list = c('a',a))
rm(list = c('a',a))\
a <- load("~/.RData")
a
rm(list = c('a',a))\
rm(list = c('a',a))
rm(list = c('a',a))
rm(list = list('a',a))
rm(list=c(a,'a'))
a <- load("~/.RData")
rm(list=c(a,'a'))
a <- load(file="~/.RData")
a
rm(list = c(a,'a'))
theloadedobjects  <- load(file="~/.RData")
theloadedobjects
rm(list=c(theloadedobjects, "theloadedobjects"))
View(df)
rm
clear
theloadedobjects  <- load(file="~/.RData")
rm(list=c(theloadedobjects, "theloadedobjects"))
rm(list=c(theloadedobjects, "theloadedobjects"))
rm(list=c(theloadedobjects, "theloadedobjects"))
theloadedobjects  <- load(file="~/.RData")
c(theloadedobjects, "theloadedobjects")
a <- c(theloadedobjects, "theloadedobjects")
rm(a)
rm(b)
View(co)
